/* zuck.js - https://github.com/ramon82/zuck.js */
window.ZuckitaDaGalera=window.Zuck=function(t,A){var u=document,c=this;"string"==typeof t&&(t=u.getElementById(t));var m=function(a){return u.querySelectorAll(a)[0]},e=function(a,b){return a?a[b]||"":""},v=function(a,b){if(a)for(var d=a.length,k=0;k<d;k++)b(k,a[k])},B=function(a,b,d){b=[b.toLowerCase(),"webkit"+b,"MS"+b,"o"+b];v(b,function(b,c){a[c]=d})},L=function(a,b,d){d=[d.toLowerCase(),"webkit"+d,"MS"+d,"o"+d];v(d,function(d,c){a.addEventListener(c,b,!1)})},M=function(a,b){L(a,b,"AnimationEnd")},
R=function(a,b){a.transitionEndEvent||(a.transitionEndEvent=!0,L(a,b,"TransitionEnd"))},D=function(a,b){a.firstChild?a.insertBefore(b,a.firstChild):a.appendChild(b)},N=function(a,b){if(b)document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen();else try{a.requestFullScreen?a.requestFullScreen():a.msRequestFullScreen?a.msRequestFullScreen():a.mozRequestFullScreen?a.mozRequestFullScreen():
a.webkitRequestFullScreen&&a.webkitRequestFullScreen()}catch(d){console.log(d)}},C=function(a,b,d,k){a&&(B(a.style,"TransitionTimingFunction",k),B(a.style,"TransitionDuration",d+"ms"),B(a.style,"Transform","translate3d("+b+", 0, 0)"))},E=function(a,b,d,k){var c=0,f=0;if(a){if(a.offsetParent){do if(c+=a.offsetLeft,f+=a.offsetTop,a==k)break;while(a=a.offsetParent)}b&&(f-=b);d&&(c-=d)}return[c,f]},F=function(a){a=Number(a);var b=h("language","time"),d=[[60,b.seconds,1],[120,"1"+b.minute,""],[3600,b.minutes,
60],[7200,"1"+b.hour,""],[86400,b.hours,3600],[172800,b.yesterday,""],[604800,b.days,86400]],c=(""+a).replace(/-/g,"/").replace(/[TZ]/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"");"."==c.substr(c.length-4,1)&&(c=c.substr(0,c.length-4));isNaN((new Date(c)).getDate())&&(c=a);a=(new Date-new Date(c))/1E3;var e=b.ago,f=1;0>a&&(a=Math.abs(a),e=b.ago,f=2);for(var b=0,g;g=d[b++];)if(a<g[0])return"string"==typeof g[2]?g[f]:Math.floor(a/g[2])+" "+g[1]+" "+e;return c},l=t.id,G={skin:"snapgram",avatars:!0,
stories:[],backButton:!0,backNative:!1,autoFullScreen:!1,openEffect:!0,list:!1,localStorage:!0,callbacks:{onOpen:function(a,b){b()},onView:function(a){},onEnd:function(a,b){b()},onClose:function(a,b){b()},onNextItem:function(a,b,c){c()}},language:{unmute:"Touch to unmute",keyboardTip:"Press space to see next",visitLink:"Visit link",time:{ago:"ago",hour:"hour",hours:"hours",minute:"minute",minutes:"minutes",fromnow:"from now",seconds:"seconds",yesterday:"yesterday",tomorrow:"tomorrow",days:"days"}}},
h=function(a,b){var c=function(a){return"undefined"!==typeof a};return b?c(A[a])?c(A[a][b])?A[a][b]:G[a][b]:G[a][b]:c(A[a])?A[a]:G[a]},z=new function(){var a=e("#zuck-modal");a||(a=u.createElement("div"),a.id="zuck-modal",a.innerHTML='<div id="zuck-modal-content"></div>',a.style.display="none",a.setAttribute("tabIndex","1"),a.onkeyup=function(a){a=a.keyCode;27==a?z.close():13!=a&&32!=a||z.next()},h("openEffect")&&a.classList.add("with-effects"),R(a,function(){a.classList.contains("closed")&&(b.innerHTML=
"",a.style.display="none",a.classList.remove("closed"),a.classList.remove("animated"))}),u.body.appendChild(a));var b=m("#zuck-modal-content"),d=function(a){var b="",d="",f="0",e=m("#zuck-modal-slider-"+l),p={previous:m("#zuck-modal .story-viewer.previous"),next:m("#zuck-modal .story-viewer.next"),viewing:m("#zuck-modal .story-viewer.viewing")};if(!p.previous&&!a||!p.next&&a)return!1;a?(b="next",d="previous"):(b="previous",d="next");f=E(p[b]);f=-1*f[0];C(e,f+"px",300,null);setTimeout(function(){if(""!=
b&&p[b]&&""!=d){var a=p[b].getAttribute("data-story-id");c.internalData.currentStory=a;(a=m("#zuck-modal .story-viewer."+d))&&a.parentNode.removeChild(a);p.viewing&&(p.viewing.classList.add("stopped"),p.viewing.classList.add(d),p.viewing.classList.remove("viewing"));p[b]&&(p[b].classList.remove("stopped"),p[b].classList.remove(b),p[b].classList.add("viewing"))}(a=H(b))&&k(a,b);var a=c.internalData.currentStory,f=m('#zuck-modal [data-story-id="'+a+'"]').querySelectorAll("[data-index].active"),g=f[0].firstElementChild;
c.data[a].currentItem=parseInt(f[0].getAttribute("data-index"),10);f[0].innerHTML='<b style="'+g.style.cssText+'"></b>';M(f[0].firstElementChild,function(){c.nextItem(!1)});C(e,"0px",0,null);I([f[0],f[1]],!0);h("callbacks","onView")(c.internalData.currentStory)},350)},k=function(a,b,d){var f=m("#zuck-modal-slider-"+l),k="",g="",w=e(a,"id"),q=u.createElement("div"),x=e(a,"currentItem")||0,y="";if(m('#zuck-modal .story-viewer[data-story-id="'+w+'"]'))return!1;q.className="slides";v(e(a,"items"),function(b,
c){x>b&&(a.items[b].seem=!0,c.seem=!0);var d=e(c,"length"),f=e(c,"linkText"),w=!0===e(c,"seem")?"seem":"",r='data-index="'+b+'" data-item-id="'+e(c,"id")+'"';x===b&&(y=F(e(c,"time")));g+="<span "+r+' class="'+(x===b?"active":"")+" "+w+'"><b style="animation-duration:'+(""===d?"3":d)+'s"></b></span>';k+='<div data-time="'+e(c,"time")+'" data-type="'+e(c,"type")+'"'+r+' class="item '+w+" "+(x===b?"active":"")+'">'+("video"===e(c,"type")?'<video class="media" muted webkit-playsinline playsinline preload="auto" src="'+
e(c,"src")+'" '+e(c,"type")+'></video><b class="tip muted">'+h("language","unmute")+"</b>":'<img class="media" src="'+e(c,"src")+'" '+e(c,"type")+">")+(e(c,"link")?'<a class="tip link" href="'+e(c,"link")+'" rel="noopener" target="_blank">'+(""==f?h("language","visitLink"):f)+"</a>":"")+"</div>"});q.innerHTML=k;var r=q.querySelector("video"),J=function(a){a.muted?n.classList.add("muted"):n.classList.remove("muted")};r&&(r.onwaiting=function(a){r.paused&&(n.classList.add("paused"),n.classList.add("loading"))},
r.onplay=function(){J(r);n.classList.remove("stopped");n.classList.remove("paused");n.classList.remove("loading")},r.onready=r.onload=r.onplaying=r.oncanplay=function(){J(r);n.classList.remove("loading")},r.onvolumechange=function(){J(r)});var n=u.createElement("div");n.className="story-viewer muted "+b+" "+(d?"":"stopped")+" "+(h("backButton")?"with-back-button":"");n.setAttribute("data-story-id",w);d='<div class="head"><div class="left">'+(h("backButton")?'<a class="back">&lsaquo;</a>':"")+'<u class="img" style="background-image:url('+
e(a,"photo")+');"></u><div><strong>'+e(a,"name")+'</strong><span class="time">'+y+'</span></div></div><div class="right"><span class="time">'+y+'</span><span class="loading"></span><a class="close" tabIndex="2">&times;</a></div></div><div class="slides-pointers"><div>'+g+"</div></div>";n.innerHTML=d;v(n.querySelectorAll(".close, .back"),function(a,b){b.onclick=function(a){a.preventDefault();z.close()}});n.appendChild(q);"viewing"==b&&I(n.querySelectorAll('[data-index="'+x+'"].active'),!1);v(n.querySelectorAll(".slides-pointers [data-index] > b"),
function(a,b){M(b,function(){c.nextItem(!1)})});"previous"==b?D(f,n):f.appendChild(n)},q=function(b){var f,k,e,h,q,l,v=function(c){var d=m("#zuck-modal .viewing");if("A"==c.target.nodeName)return!0;c.preventDefault();c=c.touches?c.touches[0]:c;var g=E(m("#zuck-modal .story-viewer.viewing"));a.slideWidth=m("#zuck-modal .story-viewer").offsetWidth;f=g[0];k={x:c.pageX,y:c.pageY,time:Date.now()};e=void 0;h={};b.addEventListener("mousemove",x);b.addEventListener("mouseup",y);b.addEventListener("mouseleave",
y);b.addEventListener("touchmove",x);b.addEventListener("touchend",y);d.classList.add("paused");S();q=setTimeout(function(){d.classList.add("longPress")},600);l=setTimeout(function(){clearInterval(l);l=!1},250)},x=function(a){var c=a.touches?a.touches[0]:a,d=c.pageX,c=c.pageY;k&&(h={x:d-k.x,y:c-k.y},"undefined"===typeof e&&(e=!!(e||Math.abs(h.x)<Math.abs(h.y))),!e&&k&&(a.preventDefault(),C(b,f+h.x+"px",0,null)))},y=function(g){var w=m("#zuck-modal .viewing");if(h){u.querySelectorAll("#zuck-modal .story-viewer");
var n=k?Date.now()-k.time:void 0,n=300>Number(n)&&25<Math.abs(h.x)||Math.abs(h.x)>a.slideWidth/3,p=0>h.x,r=p?m("#zuck-modal .story-viewer.next"):m("#zuck-modal .story-viewer.previous");e||(!n||p&&!r||!p&&!r?C(b,f,300):d(p,!0));k=void 0;b.removeEventListener("mousemove",x);b.removeEventListener("mouseup",y);b.removeEventListener("mouseleave",y);b.removeEventListener("touchmove",x);b.removeEventListener("touchend",y)}n=c.internalData.currentVideoElement;q&&clearInterval(q);w.classList.remove("longPress");
w.classList.remove("paused");if(l)if(clearInterval(l),l=!1,w.classList.contains("muted")&&n)O(n,w);else return c.nextItem(g),!1};b.addEventListener("touchstart",v);b.addEventListener("mousedown",v)};return{show:function(d,e){h("callbacks","onOpen")(d,function(){b.innerHTML='<div id="zuck-modal-slider-'+l+'" class="slider"></div>';var e=c.data[d],f=e.currentItem||0,g=m("#zuck-modal-slider-"+l);q(g);c.internalData.currentStory=d;e.currentItem=f;h("backNative")&&(location.hash="#!"+l);(f=H("previous"))&&
k(f,"previous");k(e,"viewing",!0);(e=H("next"))&&k(e,"next");h("autoFullScreen")&&a.classList.add("fullscreen");var p=function(){a.classList.contains("fullscreen")&&h("autoFullScreen")&&1024>=window.screen.width&&N(a);a.focus()};h("openEffect")?(e=m("#"+l+' [data-id="'+d+'"] .img'),f=E(e),a.style.marginLeft=f[0]+e.offsetWidth/2+"px",a.style.marginTop=f[1]+e.offsetHeight/2+"px",a.style.display="block",setTimeout(function(){a.classList.add("animated")},10),setTimeout(function(){p()},300)):(a.style.display=
"block",p());h("callbacks","onView")(d)})},next:function(a){h("callbacks","onEnd")(c.internalData.currentStory,function(){var a=c.internalData.currentStory,b=m("#"+l+' [data-id="'+a+'"]');b&&(b.classList.add("seem"),c.data[a].seem=!0,c.internalData.seemItems[a]=!0,P("seemItems",c.internalData.seemItems),K());m("#zuck-modal .story-viewer.next")?d(!0):z.close()})},close:function(){h("callbacks","onClose")(c.internalData.currentStory,function(){h("backNative")&&(location.hash="");N(a,!0);h("openEffect")?
a.classList.add("closed"):(b.innerHTML="",a.style.display="none")})}}},T=function(a){a=a.getAttribute("data-id");var b=u.querySelectorAll("#"+l+' [data-id="'+a+'"] .items > li'),d=[];v(b,function(a,b){var c=b.firstElementChild,e=c.firstElementChild;d.push({src:c.getAttribute("href"),length:c.getAttribute("data-length"),type:c.getAttribute("data-type"),time:c.getAttribute("data-time"),link:c.getAttribute("data-link"),preview:e.getAttribute("src")})});c.data[a].items=d},Q=function(a){var b=a.getAttribute("data-id"),
d=!1;c.internalData.seemItems[b]&&(d=!0);d?a.classList.add("seem"):a.classList.remove("seem");try{c.data[b]={id:b,photo:a.getAttribute("data-photo"),name:a.firstElementChild.lastElementChild.firstChild.innerText,link:a.firstElementChild.getAttribute("href"),lastUpdated:a.getAttribute("data-last-updated"),seem:d,items:[]}}catch(k){c.data[b]={items:[]}}a.onclick=function(a){a.preventDefault();z.show(b)}},H=function(a){var b=c.internalData.currentStory;a+="ElementSibling";return b&&(b=m("#"+l+' [data-id="'+
b+'"]')[a])?(b=b.getAttribute("data-id"),c.data[b]||!1):!1},K=function(){v(u.querySelectorAll("#"+l+" .story.seem"),function(a,b){var d=c.data[b.getAttribute("data-id")];b.parentNode.removeChild(b);c.add(d,!0)})},I=function(a,b){var d=a[1],e=a[0],h=e.parentNode.parentNode.parentNode;if(!d||!e)return!1;var f=c.internalData.currentVideoElement;f&&f.pause();if("video"==d.getAttribute("data-type")){var g=d.getElementsByTagName("video")[0];if(!g)return c.internalData.currentVideoElement=!1;d=function(){g.duration&&
B(e.getElementsByTagName("b")[0].style,"AnimationDuration",g.duration+"s")};d();g.addEventListener("loadedmetadata",d);c.internalData.currentVideoElement=g;g.currentTime=0;g.play();b.target&&O(g,h)}else c.internalData.currentVideoElement=!1},S=function(){var a=c.internalData.currentVideoElement;if(a)try{a.pause()}catch(b){}},O=function(a,b){a.muted=!1;a.volume=1;a.removeAttribute("muted");a.play();a.paused&&(a.muted=!0,a.play());b&&b.classList.remove("paused")},P=function(a,b){h("localStorage")&&
(window.localStorage["zuck-"+l+"-"+a]=JSON.stringify(b))};c.data={};c.internalData={};c.internalData.seemItems=function(a){return h("localStorage")?(a="zuck-"+l+"-"+a,window.localStorage[a]?JSON.parse(window.localStorage[a]):!1):!1}("seemItems")||{};c.add=c.update=function(a,b){var d=e(a,"id"),k=m("#"+l+' [data-id="'+d+'"]'),q="",f=e(a,"items"),g=!1;c.data[d]={};k?g=k:(g=u.createElement("div"),g.className="story");!1===a.seem&&(c.internalData.seemItems[d]=!1,P("seemItems",c.internalData.seemItems));
g.setAttribute("data-id",d);g.setAttribute("data-photo",e(a,"photo"));g.setAttribute("data-last-updated",e(a,"lastUpdated"));q=!1;f[0]&&(q=f[0].preview||"");q='<a href="'+e(a,"link")+'"><span class="img"><u style="background-image:url('+(h("avatars")||!q||""==q?e(a,"photo"):q)+')"></u></span><span class="info"><strong>'+e(a,"name")+'</strong><span class="time">'+F(e(a,"lastUpdated"))+'</span></span></a><ul class="items"></ul>';g.innerHTML=q;Q(g);k||(b?t.appendChild(g):D(t,g));v(f,function(a,e){c.addItem(d,
e,b)});b||K()};c.next=function(){z.next()};c.addItem=function(a,b,c){a=m("#"+l+' > [data-id="'+a+'"]');var d=u.createElement("li");d.className=e(b,"seem")?"seem":"";d.setAttribute("data-id",e(b,"id"));d.innerHTML='<a href="'+e(b,"src")+'" data-link="'+e(b,"link")+'" data-time="'+e(b,"time")+'" data-type="'+e(b,"type")+'" data-length="'+e(b,"length")+'"><img src="'+e(b,"preview")+'"></a>';b=a.querySelectorAll(".items")[0];c?b.appendChild(d):D(b,d);T(a)};c.removeItem=function(a,b){var c=m("#"+l+' > [data-id="'+
a+'"] [data-id="'+b+'"]');t.parentNode.removeChild(c)};c.nextItem=function(a){var b=c.internalData.currentStory,d=c.data[b].currentItem,e=m('#zuck-modal .story-viewer[data-story-id="'+b+'"]');if(!e||1==e.touchMove)return!1;var l=e.querySelectorAll('[data-index="'+d+'"]'),f=l[0],g=l[1],w=e.querySelectorAll('[data-index="'+(d+1)+'"]'),u=w[0],t=w[1];e&&u&&t?h("callbacks","onNextItem")(b,t.getAttribute("data-story-id"),function(){f.classList.remove("active");f.classList.add("seem");g.classList.remove("active");
g.classList.add("seem");u.classList.remove("seem");u.classList.add("active");t.classList.remove("seem");t.classList.add("active");v(e.querySelectorAll(".time"),function(a,b){b.innerText=F(t.getAttribute("data-time"))});c.data[b].currentItem++;I(w,a)}):e&&z.next(a)};return function(){location.hash=="#!"+l&&(location.hash="");m("#"+l+" .story")&&v(t.querySelectorAll(".story"),function(a,b){Q(b,!0)});h("backNative")&&window.addEventListener("popstate",function(a){location.hash!="#!"+l&&(location.hash=
"")},!1);v(h("stories"),function(a,b){c.add(b,!0)});K();var a=h("avatars")?"user-icon":"story-preview",b=h("list")?"list":"carousel";t.className="stories "+a+" "+b+" "+(h("skin")+"").toLowerCase();return c}()};