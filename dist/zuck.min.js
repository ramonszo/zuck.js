(function(n){var g=function(b){return document.querySelectorAll(b)[0]},b=function(b,g){return b?b[g]||"":""},w=function(b,g){if(b)for(var d=b.length,h=0;h<d;h++)g(h,b[h])},z=function(b,g,d){g=[g.toLowerCase(),"webkit".concat(g),"MS".concat(g),"o".concat(g)];w(g,function(h,g){b[g]=d})},D=function(b,g,d){d=[d.toLowerCase(),"webkit".concat(d),"MS".concat(d),"o".concat(d)];w(d,function(d,l){b.addEventListener(l,g,!1)})},M=function(b,g){D(b,g,"AnimationEnd")},R=function(b,g){b.transitionEndEvent||(b.transitionEndEvent=
!0,D(b,g,"TransitionEnd"))},G=function(b,g){b.firstChild?b.insertBefore(g,b.firstChild):b.appendChild(g)},m=function(l,m){var d=this,h=function(a,e){var c=function(a){return"undefined"!==typeof a};return e?c(m[a])?c(m[a][e])?m[a][e]:F[a][e]:F[a][e]:c(m[a])?m[a]:F[a]},L=function(a,e){try{if(e){if(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)if(document.exitFullscreen)document.exitFullscreen()["catch"](function(){});else if(document.mozCancelFullScreen)document.mozCancelFullScreen()["catch"](function(){});
else if(document.mozCancelFullScreen)document.mozCancelFullScreen()["catch"](function(){})}else if(a.requestFullScreen)a.requestFullScreen();else if(a["ms".concat("RequestFullScreen")])a["ms".concat("RequestFullScreen")]();else if(a["moz".concat("RequestFullScreen")])a["moz".concat("RequestFullScreen")]();else if(a["webkit".concat("RequestFullScreen")])a["webkit".concat("RequestFullScreen")]()}catch(c){console.warn("[Zuck.js] Can't access fullscreen")}},y=function(a,e,c,d){var b=0<e?1:-1;b*=Math.abs(e)/
g("#zuck-modal").offsetWidth*90;if(h("cubeEffect")){var f=0===b?"scale(0.95)":"scale(0.930,0.930)";z(g("#zuck-modal-content").style,"Transform",f);if(-90>b||90<b)return!1}e=h("cubeEffect")?"rotateY(".concat(b,"deg)"):"translate3d(".concat(e,"px, 0, 0)");a&&(z(a.style,"TransitionTimingFunction",d),z(a.style,"TransitionDuration","".concat(c,"ms")),z(a.style,"Transform",e))},A=function(a,e,c,d){var b=0,f=0;if(a){if(a.offsetParent){do if(b+=a.offsetLeft,f+=a.offsetTop,a===d)break;while(a=a.offsetParent)
}e&&(f-=e);c&&(b-=c)}return[b,f]};"string"===typeof l&&(l=document.getElementById(l));l.id||l.setAttribute("id","stories-"+Math.random().toString(36).substr(2,9));var H=function(a){a=1E3*Number(a);a=new Date(a);var e=a.getTime();e=((new Date).getTime()-e)/1E3;var c=h("language","time");c=[[60," ".concat(c.seconds),1],[120,"1 ".concat(c.minute),""],[3600," ".concat(c.minutes),60],[7200,"1 ".concat(c.hour),""],[86400," ".concat(c.hours),3600],[172800," ".concat(c.yesterday),""],[604800," ".concat(c.days),
86400]];var d=1;0>e&&(e=Math.abs(e),d=2);for(var b=0,f;f=c[b++];)if(e<f[0])return"string"===typeof f[2]?f[d]:Math.floor(e/f[2])+f[1];e=a.getDate();c=a.getMonth();a=a.getFullYear();return"".concat(e,"/").concat(c+1,"/").concat(a)},k=l.id,F={skin:"snapgram",avatars:!0,stories:[],backButton:!0,backNative:!1,paginationArrows:!1,previousTap:!0,autoFullScreen:!1,openEffect:!0,cubeEffect:!1,list:!1,localStorage:!0,callbacks:{onOpen:function(a,d){d()},onView:function(a){},onEnd:function(a,d){d()},onClose:function(a,
d){d()},onNextItem:function(a,d,c){c()},onNavigateItem:function(a,d,c){c()}},template:{timelineItem:function(a){return'\n<div class="story '.concat(!0===b(a,"seen")?"seen":"",'">\n<a class="item-link" href="').concat(b(a,"link"),'">\n<span class="item-preview">\n<img lazy="eager" src="').concat(h("avatars")||!b(a,"currentPreview")?b(a,"photo"):b(a,"currentPreview"),'" />\n</span>\n<span class="info" itemProp="author" itemScope itemType="http://schema.org/Person">\n<strong class="name" itemProp="name">').concat(b(a,
"name"),'</strong>\n<span class="time">').concat(b(a,"lastUpdatedAgo"),'</span>\n</span>\n</a>\n\n<ul class="items"></ul>\n</div>')},timelineStoryItem:function(a){return'<a href="'.concat(b(a,"src"),'"\ndata-link="').concat(b(a,"link"),'"\ndata-linkText="').concat(b(a,"linkText"),'"\ndata-time="').concat(b(a,"time"),'"\ndata-type="').concat(b(a,
"type"),'"\ndata-length="').concat(b(a,"length"),'">\n<img loading="auto" src="').concat(b(a,"preview"),'" />\n</a>')},viewerItem:function(a,d){return'<div class="story-viewer">\n<div class="head">\n<div class="left">\n'.concat(h("backButton")?'<a class="back">&lsaquo;</a>':"",'\n\n<span class="item-preview">\n<img lazy="eager" class="profilePhoto" src="').concat(b(a,
"photo"),'" />\n</span>\n\n<div class="info">\n<strong class="name">').concat(b(a,"name"),'</strong>\n<span class="time">').concat(b(a,"timeAgo"),'</span>\n</div>\n</div>\n\n<div class="right">\n<span class="time">').concat(b(d,"timeAgo"),'</span>\n<span class="loading"></span>\n<a class="close" tabIndex="2">&times;</a>\n</div>\n</div>\n\n<div class="slides-pointers">\n<div class="wrap"></div>\n</div>\n\n').concat(h("paginationArrows")?
'<div class="slides-pagination">\n<span class="previous">&lsaquo;</span>\n<span class="next">&rsaquo;</span>\n</div>':"","\n</div>")},viewerItemPointer:function(a,d,c){return'<span \nclass="'.concat(d===a?"active":""," ").concat(!0===b(c,"seen")?"seen":"",'"\ndata-index="').concat(a,'" data-item-id="').concat(b(c,"id"),'">\n<b style="animation-duration:').concat(""===
b(c,"length")?"3":b(c,"length"),'s"></b>\n</span>')},viewerItemBody:function(a,d,c){return'<div \nclass="item '.concat(!0===b(c,"seen")?"seen":""," ").concat(d===a?"active":"",'"\ndata-time="').concat(b(c,"time"),'" data-type="').concat(b(c,"type"),'" data-index="').concat(a,'" data-item-id="').concat(b(c,"id"),'">\n').concat("video"===b(c,"type")?'<video class="media" muted webkit-playsinline playsinline preload="auto" src="'.concat(b(c,
"src"),'" ').concat(b(c,"type"),'></video>\n<b class="tip muted">').concat(h("language","unmute"),"</b>"):'<img loading="auto" class="media" src="'.concat(b(c,"src"),'" ').concat(b(c,"type")," />\n"),"\n\n").concat(b(c,"link")?'<a class="tip link" href="'.concat(b(c,"link"),'" rel="noopener" target="_blank">\n').concat(b(c,"linkText")&&""!==b(c,"linkText")?b(c,"linkText"):h("language","visitLink"),"\n</a>"):
"","\n</div>")}},language:{unmute:"Touch to unmute",keyboardTip:"Press space to see next",visitLink:"Visit link",time:{ago:"ago",hour:"hour ago",hours:"hours ago",minute:"minute ago",minutes:"minutes ago",fromnow:"from now",seconds:"seconds ago",yesterday:"yesterday",tomorrow:"tomorrow",days:"days ago"}}},B=function(){var a=g("#zuck-modal");a||d.hasModal||(d.hasModal=!0,a=document.createElement("div"),a.id="zuck-modal",h("cubeEffect")&&(a.className="with-cube"),a.innerHTML='<div id="zuck-modal-content"></div>',
a.style.display="none",a.setAttribute("tabIndex","1"),a.onkeyup=function(a){a=a.keyCode;27===a?B.close():(13===a||32===a)&&B.next()},h("openEffect")&&a.classList.add("with-effects"),R(a,function(){a.classList.contains("closed")&&(e.innerHTML="",a.style.display="none",a.classList.remove("closed"),a.classList.remove("animated"))}),document.body.appendChild(a));var e=g("#zuck-modal-content"),c=function(a){var c=g("#zuck-modal"),b="",e="",f=0,p=g("#zuck-modal-slider-".concat(k)),r={previous:g("#zuck-modal .story-viewer.previous"),
next:g("#zuck-modal .story-viewer.next"),viewing:g("#zuck-modal .story-viewer.viewing")};if(!r.previous&&!a||!r.next&&a)return!1;a?(b="next",e="previous"):(b="previous",e="next");h("cubeEffect")?"previous"===b?f=c.slideWidth:"next"===b&&(f=-1*c.slideWidth):f=-1*A(r[b])[0];y(p,f,600,null);setTimeout(function(){if(""!==b&&r[b]&&""!==e){var a=r[b].getAttribute("data-story-id");d.internalData.currentStory=a;var c=g("#zuck-modal .story-viewer.".concat(e));c&&c.parentNode.removeChild(c);r.viewing&&(r.viewing.classList.add("stopped"),
r.viewing.classList.add(e),r.viewing.classList.remove("viewing"));r[b]&&(r[b].classList.remove("stopped"),r[b].classList.remove(b),r[b].classList.add("viewing"));(c=I(b))&&q(c,b);var f=d.internalData.currentStory;if(c=g('#zuck-modal [data-story-id="'.concat(f,'"]'))){c=c.querySelectorAll("[data-index].active");var v=c[0].firstElementChild;d.data[f].currentItem=parseInt(c[0].getAttribute("data-index"),10);c[0].innerHTML='<b style="'.concat(v.style.cssText,'"></b>');M(c[0].firstElementChild,function(){d.nextItem(!1)})}y(p,
"0",0,null);c&&(a=g('#zuck-modal .story-viewer[data-story-id="'.concat(a,'"]')),E(a,[c[0],c[1]],!0));h("callbacks","onView")(d.internalData.currentStory)}},650)},q=function(a,c,e){var f=g("#zuck-modal-slider-".concat(k)),q=b(a,"items");a.timeAgo=q&&q[0]?H(b(q[0],"time")):"";var v="",p="",l=b(a,"id"),m=document.createElement("div"),x=b(a,"currentItem")||0;if(g('#zuck-modal .story-viewer[data-story-id="'.concat(l,'"]')))return!1;m.className="slides";w(q,function(c,d){d.timeAgo=H(b(d,"time"));x>c&&(a.items[c].timeAgo=
d.timeAgo,a.items[c].seen=!0,d.seen=!0);p+=h("template","viewerItemPointer")(c,x,d);v+=h("template","viewerItemBody")(c,x,d)});m.innerHTML=v;var t=m.querySelector("video"),n=function(a){a.muted?u.classList.add("muted"):u.classList.remove("muted")};t&&(t.onwaiting=function(a){t.paused&&(u.classList.add("paused"),u.classList.add("loading"))},t.onplay=function(){n(t);u.classList.remove("stopped");u.classList.remove("paused");u.classList.remove("loading")},t.onload=t.onplaying=t.oncanplay=function(){n(t);
u.classList.remove("loading")},t.onvolumechange=function(){n(t)});q=document.createElement("div");q.innerHTML=h("template","viewerItem")(a,x);var u=q.firstElementChild;u.className="story-viewer muted ".concat(c," ").concat(e?"":"stopped"," ").concat(h("backButton")?"with-back-button":"");u.setAttribute("data-story-id",l);u.querySelector(".slides-pointers .wrap").innerHTML=p;w(u.querySelectorAll(".close, .back"),function(a,c){c.onclick=function(a){a.preventDefault();B.close()}});u.appendChild(m);"viewing"===
c&&E(u,u.querySelectorAll('[data-index="'.concat(x,'"].active')),!1);w(u.querySelectorAll(".slides-pointers [data-index] > b"),function(a,c){M(c,function(){d.nextItem(!1)})});"previous"===c?G(f,u):f.appendChild(u)},p=function(a){var b=g("#zuck-modal"),e,f=void 0,q=void 0,p=void 0,r=void 0,l=void 0,k=function(c){var d=g("#zuck-modal .viewing");if("A"!==c.target.nodeName){var h=c.touches?c.touches[0]:c,v=A(g("#zuck-modal .story-viewer.viewing"));b.slideWidth=g("#zuck-modal .story-viewer").offsetWidth;
b.slideHeight=g("#zuck-modal .story-viewer").offsetHeight;e=v[0];v=h.clientY;f={x:h.clientX,y:v,time:Date.now(),valid:!0};80>v||v>b.slideHeight-80?f.valid=!1:(c.preventDefault(),q=void 0,p={},a.addEventListener("mousemove",m),a.addEventListener("mouseup",t),a.addEventListener("mouseleave",t),a.addEventListener("touchmove",m),a.addEventListener("touchend",t),d&&d.classList.add("paused"),S(),r=setTimeout(function(){d.classList.add("longPress")},600),l=setTimeout(function(){clearInterval(l);l=!1},250))}},
m=function(c){var d=c.touches?c.touches[0]:c,b=d.clientX;d=d.clientY;f&&f.valid&&(p={x:b-f.x,y:d-f.y},"undefined"===typeof q&&(q=!!(q||Math.abs(p.x)<Math.abs(p.y))),!q&&f&&(c.preventDefault(),y(a,e+p.x,0,null)))},t=function J(v){var k=g("#zuck-modal .viewing"),u=f,x=f?Date.now()-f.time:void 0;x=300>Number(x)&&25<Math.abs(p.x)||Math.abs(p.x)>b.slideWidth/3;var C=0>p.x,t=C?g("#zuck-modal .story-viewer.next"):g("#zuck-modal .story-viewer.previous");t=C&&!t||!C&&!t;if(!f||f.valid)if(p&&(q||(x&&!t?c(C):
y(a,e,300)),f=void 0,a.removeEventListener("mousemove",m),a.removeEventListener("mouseup",J),a.removeEventListener("mouseleave",J),a.removeEventListener("touchmove",m),a.removeEventListener("touchend",J)),x=d.internalData.currentVideoElement,r&&clearInterval(r),k&&(E(k,k.querySelectorAll(".active"),!1),k.classList.remove("longPress"),k.classList.remove("paused")),l)if(clearInterval(l),l=!1,k=function(){C||(u.x>n.screen.width/3||!h("previousTap")?d.navigateItem("next",v):d.navigateItem("previous",
v))},(t=g("#zuck-modal .viewing"))&&x)t.classList.contains("muted")?N(x,t):k();else return k(),!1};a.addEventListener("touchstart",k);a.addEventListener("mousedown",k)};return{show:function(a,c){var b=g("#zuck-modal");h("callbacks","onOpen")(a,function(){e.innerHTML='<div id="zuck-modal-slider-'.concat(k,'" class="slider"></div>');var c=d.data[a],f=c.currentItem||0,v=g("#zuck-modal-slider-".concat(k));p(v);d.internalData.currentStory=a;c.currentItem=f;h("backNative")&&(n.location.hash="#!".concat(k));
(f=I("previous"))&&q(f,"previous");q(c,"viewing",!0);(c=I("next"))&&q(c,"next");h("autoFullScreen")&&b.classList.add("fullscreen");var l=function(){b.classList.contains("fullscreen")&&h("autoFullScreen")&&1024>=n.screen.width&&L(b);b.focus()};h("openEffect")?(c=g("#".concat(k,' [data-id="').concat(a,'"] .item-preview')),f=A(c),b.style.marginLeft="".concat(f[0]+c.offsetWidth/2,"px"),b.style.marginTop="".concat(f[1]+c.offsetHeight/2,"px"),b.style.display="block",b.slideWidth=g("#zuck-modal .story-viewer").offsetWidth,
setTimeout(function(){b.classList.add("animated")},10),setTimeout(function(){l()},300)):(b.style.display="block",b.slideWidth=g("#zuck-modal .story-viewer").offsetWidth,l());h("callbacks","onView")(a)})},next:function(a){h("callbacks","onEnd")(d.internalData.currentStory,function(){var a=d.internalData.currentStory,b=g("#".concat(k,' [data-id="').concat(a,'"]'));b&&(b.classList.add("seen"),d.data[a].seen=!0,d.internalData.seenItems[a]=!0,O("seenItems",d.internalData.seenItems),K());g("#zuck-modal .story-viewer.next")?
c(!0):B.close()})},close:function(){var a=g("#zuck-modal");h("callbacks","onClose")(d.internalData.currentStory,function(){h("backNative")&&(n.location.hash="");L(a,!0);h("openEffect")?a.classList.add("closed"):(e.innerHTML="",a.style.display="none")})}}}(),D=function(a,b){var c=a.getAttribute("data-id"),e=document.querySelectorAll("#".concat(k,' [data-id="').concat(c,'"] .items > li')),g=[];if(!h("reactive")||b)w(e,function(a,c){var b=c.firstElementChild,d=b.firstElementChild;g.push({id:b.getAttribute("data-id"),
src:b.getAttribute("href"),length:b.getAttribute("data-length"),type:b.getAttribute("data-type"),time:b.getAttribute("data-time"),link:b.getAttribute("data-link"),linkText:b.getAttribute("data-linkText"),preview:d.getAttribute("src")})}),d.data[c].items=g,(c=h("callbacks","onDataUpdate"))&&c(d.data,function(){})},P=function(a,b){var c=a.getAttribute("data-id"),e=!1;d.internalData.seenItems[c]&&(e=!0);try{d.data[c]||(d.data[c]={}),d.data[c].id=c,d.data[c].photo=a.getAttribute("data-photo"),d.data[c].name=
a.querySelector(".name").innerText,d.data[c].link=a.querySelector(".item-link").getAttribute("href"),d.data[c].lastUpdated=a.getAttribute("data-last-updated"),d.data[c].seen=e,d.data[c].items||(d.data[c].items=[],d.data[c].noItems=!0)}catch(p){d.data[c]={items:[]}}a.onclick=function(a){a.preventDefault();B.show(c)};(e=h("callbacks","onDataUpdate"))&&e(d.data,function(){})},I=function(a){var b=d.internalData.currentStory;a="".concat(a,"ElementSibling");return b&&(b=g("#".concat(k,' [data-id="').concat(b,
'"]'))[a])?(b=b.getAttribute("data-id"),d.data[b]||!1):!1},K=function(){w(document.querySelectorAll("#".concat(k," .story.seen")),function(a,b){var c=d.data[b.getAttribute("data-id")],e=b.parentNode;h("reactive")||e.removeChild(b);d.update(c,!0)})},E=function(a,b,c){var e=b[1],g=b[0];if(!e||!g)return!1;(b=d.internalData.currentVideoElement)&&b.pause();if("video"===e.getAttribute("data-type")){var f=e.getElementsByTagName("video")[0];if(!f)return d.internalData.currentVideoElement=!1;e=function(){f.duration&&
z(g.getElementsByTagName("b")[0].style,"AnimationDuration","".concat(f.duration,"s"))};e();f.addEventListener("loadedmetadata",e);d.internalData.currentVideoElement=f;f.play();c&&c.target&&N(f,a)}else d.internalData.currentVideoElement=!1},S=function(){var a=d.internalData.currentVideoElement;if(a)try{a.pause()}catch(e){}},N=function(a,b){a.muted=!1;a.volume=1;a.removeAttribute("muted");a.play();a.paused&&(a.muted=!0,a.play());b&&b.classList.remove("paused")},O=function(a,b){try{if(h("localStorage")){var c=
"zuck-".concat(k,"-").concat(a);n.localStorage[c]=JSON.stringify(b)}}catch(q){}},Q=function(a){return h("localStorage")?(a="zuck-".concat(k,"-").concat(a),n.localStorage[a]?JSON.parse(n.localStorage[a]):!1):!1};d.data=h("stories")||{};d.internalData={};d.internalData.seenItems=Q("seenItems")||{};d.add=d.update=function(a,e){var c=b(a,"id"),q=g("#".concat(k,' [data-id="').concat(c,'"]')),p=b(a,"items"),f=void 0;f=!1;p[0]&&(f=p[0].preview||"");!0===d.internalData.seenItems[c]&&(a.seen=!0);a.currentPreview=
f;q?f=q:(f=document.createElement("div"),f.innerHTML=h("template","timelineItem")(a),f=f.firstElementChild);!1===a.seen&&(d.internalData.seenItems[c]=!1,O("seenItems",d.internalData.seenItems));f.setAttribute("data-id",c);f.setAttribute("data-photo",b(a,"photo"));f.setAttribute("data-last-updated",b(a,"lastUpdated"));P(f);q||h("reactive")||(e?l.appendChild(f):G(l,f));w(p,function(a,b){d.addItem(c,b,e)});e||K()};d.next=function(){B.next()};d.remove=function(a){a=g("#".concat(k,' > [data-id="').concat(a,
'"]'));a.parentNode.removeChild(a)};d.addItem=function(a,d,c){a=g("#".concat(k,' > [data-id="').concat(a,'"]'));if(!h("reactive")){var e=document.createElement("li"),p=a.querySelectorAll(".items")[0];e.className=b(d,"seen")?"seen":"";e.setAttribute("data-id",b(d,"id"));e.innerHTML=h("template","timelineStoryItem")(d);c?p.appendChild(e):G(p,e)}D(a)};d.removeItem=function(a,b){var c=g("#".concat(k,' > [data-id="').concat(a,'"] [data-id="').concat(b,'"]'));h("reactive")||l.parentNode.removeChild(c)};
d.navigateItem=d.nextItem=function(a,b){var c=d.internalData.currentStory,e=d.data[c].currentItem,k=g('#zuck-modal .story-viewer[data-story-id="'.concat(c,'"]')),f="previous"===a?-1:1;if(!k||1===k.touchMove)return!1;var l=k.querySelectorAll('[data-index="'.concat(e,'"]')),m=l[0],n=l[1],y=k.querySelectorAll('[data-index="'.concat(e+f,'"]')),A=y[0],r=y[1];k&&A&&r?(e=(e=h("callbacks","onNavigateItem"))?h("callbacks","onNavigateItem"):h("callbacks","onNextItem"),e(c,r.getAttribute("data-story-id"),function(){"previous"===
a?(m.classList.remove("seen"),n.classList.remove("seen")):(m.classList.add("seen"),n.classList.add("seen"));m.classList.remove("active");n.classList.remove("active");A.classList.remove("seen");A.classList.add("active");r.classList.remove("seen");r.classList.add("active");w(k.querySelectorAll(".time"),function(a,b){b.innerText=H(r.getAttribute("data-time"))});d.data[c].currentItem+=f;E(k,y,b)})):k&&"previous"!==a&&B.next(b)};return function(){l&&l.querySelector(".story")&&w(l.querySelectorAll(".story"),
function(a,b){P(b)});h("backNative")&&(n.location.hash==="#!".concat(k)&&(n.location.hash=""),n.addEventListener("popstate",function(a){n.location.hash!=="#!".concat(k)&&(n.location.hash="")},!1));if(!h("reactive")){var a=Q("seenItems");for(b in a)a.hasOwnProperty(b)&&d.data[b]&&(d.data[b].seen=a[b])}w(h("stories"),function(a,b){d.add(b,!0)});K();a=h("avatars")?"user-icon":"story-preview";var b=h("list")?"list":"carousel";l.className+=" stories ".concat(a," ").concat(b," ").concat("".concat(h("skin")).toLowerCase());
return d}()};m.buildTimelineItem=function(b,g,d,h,n,y){var l={id:b,photo:g,name:d,link:h,lastUpdated:n,items:[]};w(y,function(b,d){l.items.push(m.buildStoryItem.apply(m,d))});return l};m.buildStoryItem=function(b,g,d,h,m,n,w,z,k){return{id:b,type:g,length:d,src:h,preview:m,link:n,linkText:w,seen:z,time:k}};m.buildItem=m.buildStoryItem;"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=m),exports.ZuckJS=m):n.ZuckitaDaGalera=n.Zuck=m;return m})(window||{});